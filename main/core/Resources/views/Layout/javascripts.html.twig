{% import 'ClarolineCoreBundle:Layout:javascripts.macros.html.twig' as jsmacros %}

<script type="text/javascript" src="{{ asset('packages/loadjs/dist/loadjs.min.js') }}"></script>
<script type="text/javascript">
    function load(dependencies, cb) {
        var last = dependencies.pop()
        var module = 'dep-' + last
        loadjs(dependencies, 'dep-' + last, {
            async: false,
            success: function() {
                loadjs(last, last, {
                    success: function () {
                        cb()
                    }
                })
            }
        })
    }
</script>

{# Loads all necessary twigjs files #}
{{ jsmacros.getTwigJs() }}

{# Loads all necessary libs (Backbone, underscore) and Dlls (Angular, es6-shim, pdf-player) #}
{{ jsmacros.getDlls() }}

{# Loads webpack commons.js and libraries.js (minified) files #}
{{ jsmacros.getCommonJavascripts() }}

{# Loads all necessary Bootstrap js files (minified) #}
{{ jsmacros.getBootstrapJs() }}
{# Loads Bootstrap Datepicker js files (with proper Locale) #}
{{ jsmacros.getBootstrapDatepickerJs() }}

{# TODO: remove this when custom js builds are available #}
{# Loads Jquery Ui files (minified) #}
{{ jsmacros.getJqueryUiJs() }}

{# Loads Angular Ui scripts (minified) #}
{{ jsmacros.getAngularUiJs() }}

{# Loads translator js files #}
{{ jsmacros.getTranslatorJs() }}

{# Loads fosJsRouter js files #}
{{ jsmacros.getFosRouterJs() }}

{# Loads fosJsRouter js files #}
{{ jsmacros.getLibs() }}

<script src="{{ hotAsset('dist/claroline-distribution-main-core-core-js.js') }}"></script>

<script>
    if (window.sessionStorage.getItem('hide_brower_warning')) {
        $('.outdated-browser-warning').hide();
    }
</script>

<script src='{{ hotAsset('dist/claroline-distribution-main-core-iframe.js') }}'></script>

<script src="{{ hotAsset('dist/claroline-distribution-main-core-checkbox-dropdown.js') }}"></script>
<script src="{{ hotAsset('dist/claroline-distribution-main-core-topbar.js') }}"></script>
<script src="{{ hotAsset('dist/claroline-distribution-main-core-sidebar.js') }}"></script>
<script src='{{ hotAsset('dist/claroline-distribution-main-core-locale.js') }}'></script>
<script src="{{ hotAsset('dist/claroline-distribution-main-core-startup.js') }}"></script>
<script src="{{ hotAsset('dist/claroline-distribution-main-core-modernizr.js') }}"></script>
<script src="{{ hotAsset('dist/claroline-distribution-main-core-layout-javascript.js') }}"></script>

{# Loads all appended scipts by other twig files (usually embedded twig templates or SF2 form fields templates) #}
{{ loadAppendedScripts() }}

{{ render(controller('ClarolineCoreBundle:Layout:injectJavascript', {})) }}
